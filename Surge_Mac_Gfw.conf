#!MANAGED-CONFIG https://raw.githubusercontent.com/ianzhang1/hhp/main/Surge_Mac.conf interval=86400 strict=false

[General]
# > 日志级别
loglevel = notify
# > 当遇到REJECT策略时返回错误页
show-error-page-for-reject = true
# > IPv6支持（默认关闭）
ipv6 = false
# > IPv6 VIF（默认禁用）
ipv6-vif = disabled
# > 测试超时（秒）
test-timeout = 5
# > Internet 测试 URL
internet-test-url = http://www.baidu.com
# > 代理测速URL
proxy-test-url = http://connectivitycheck.gstatic.com/generate_204
# UDP优先级
# udp-priority = false
# > GeoIP数据库
geoip-maxmind-url = https://github.com/Hackl0us/GeoIP2-CN/raw/release/Country.mmdb
# > 排除简单主机名
# exclude-simple-hostnames = true
# > DNS服务器
dns-server = 223.5.5.5, 119.29.29.29, 180.184.1.1, system
# > DNS加密服务器
encrypted-dns-server = https://dns.alidns.com/dns-query, https://doh.pub/dns-query
# > DNS劫持
hijack-dns = 8.8.8.8:53, 8.8.4.4:53
# > 远程控制器
http-api-web-dashboard = true
# > 跳过代理 (已注释)Surge 5.8.0默认VIF Only
# skip-proxy = 192.168.0.0/24, 10.0.0.0/8, 172.16.0.0/12, 127.0.0.1, 100.64.0.0/10, 17.0.0.0/8, localhost, *.local, *.crashlytics.com, seed-sequoia.siri.apple.com, sequoia.apple.com,
# > Always Real IP
always-real-ip = *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.battlenet.com.cn, *.battlenet.com, *.blzstatic.cn, *.battle.net, *.msftconnecttest.com, *.msftncsi.com,  stun.l.google.com
# > 兼容模式(若需要使用Homekit摄像头，可以开启兼容模式，但开启兼容模式会导致一些屏蔽广告的模块失效，请自行取舍)
# compatibility-mode = 5
# > Surge VIF
# tun-excluded-routes = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12
# tun-included-routes = 192.168.1.12/32
# > 禁用GEOIP自动更新
disable-geoip-db-auto-update = false
# > 当节点不支持UDP时，默认fallback到reject。如果没有代理服务器支持UDP转发，可修改为direct或注释下条，但需注意同一目标主机名TCP请求与UDP请求的源地址不同所造成的隐私及安全风险。
udp-policy-not-supported-behaviour = reject
# ================ 仅限 MacOS 的 Surge 参数 ================ #
# > 如果禁用，即使 Wi-Fi 不是主网络接口，SSID/BSSID 模式仍可匹配。
use-default-policy-if-wifi-not-primary = false
# > 遵循 /etc/hosts 中的本地 DNS 映射项
read-etc-hosts = true
# > Surge HTTP 代理服务的端口号
# http-listen = 0.0.0.0
# > Surge SOCKS5 代理服务的端口号
# socks5-listen = 0.0.0.0
# > 启用 CPU 调试模式。这可能会降低性能。
debug-cpu-usage = false
# > 启用内存调试模式。这可能会降低性能。
debug-memory-usage = false
# > vif模式
# > auto ：让Surge自动选择最合适的工作模式。
# > v1 ：传统模式，TCP协议栈完全由Surge管理。由于 Surge 运行在用户空间中，这意味着每个数据包都需要从内核空间传输到用户空间进行处理。
# > v2 ：在 5.0 版本中引入，它使用 macOS 中的数据包过滤器机制，利用 macOS 的 TCP 协议栈，从而避免了在内核空间和用户空间之间切换的开销，从而显着提高了性能。但是，由于它需要修改 pf 设置，因此它与虚拟机网络和网络共享功能不兼容。
# > v3 ：在 5.2 版中引入，它绕过了数据包过滤器，并采用另一种技术来使用 macOS 的 TCP 协议栈。性能略低于 v2，但避免了因调整 pf 设置而导致的兼容性问题。
vif-mode = v3

[Proxy]


[Proxy Group]
# > 策略组（下面的节点信息需与外部节点对应，若删除了外部节点里的节点，那么在策略组里也要删除。）
AIGC = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
苹果代理 = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
苹果服务 = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
微软服务 = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
OneDrive = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
谷歌服务 = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
Github = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
游戏平台 = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
Youtube = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
Netflix = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
TikTok = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
Disney = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
Telegram = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择
Twitter = select, 🀄️ 节点选择,☝️ 手动单选, 🇭🇰 香港节点, 🇺🇸 美国节点, 🇯🇵 日本节点, 🇨🇳 台湾节点, 🇸🇬 新加坡节点, ✅ 默认直连, ⛔️ 禁止访问, ♻️ 自动选择

# > 外部节点
🀄️ 节点选择 = select, "☝️ 手动单选", "🇭🇰 香港节点", "🇺🇸 美国节点", "🇯🇵 日本节点", "🇨🇳 台湾节点", "🇸🇬 新加坡节点", "✅ 默认直连", "⛔️ 禁止访问", "♻️ 自动选择", 
☝️ 手动单选 = select, include-all-proxies=1, policy-regex-filter=^((?!佣金|官网|免翻|到期|流量|更新|点外|重置|免流|Direct|GB|Days|Date|Expire|Premium).)*$
🇭🇰 香港节点 = url-test, include-all-proxies=1, policy-regex-filter=^(?!.*Premium).*(?:港|HK|hk|Hong Kong|HongKong|hongkong).*$, url=http://1.0.0.1/generate_204, interval=300, tolerance=50
🇺🇸 美国节点 = url-test, include-all-proxies=1, policy-regex-filter=^(?!.*Premium).*(?:美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|US|United States).*$, url=http://1.0.0.1/generate_204, interval=300, tolerance=50
🇯🇵 日本节点 = url-test, include-all-proxies=1, policy-regex-filter=^(?!.*Premium).*(?:日本|川日|东京|大阪|泉日|埼玉|沪日|深日|[^-]日|JP|Japan).*$, url=http://1.0.0.1/generate_204, interval=300, tolerance=50
🇨🇳 台湾节点 = url-test, include-all-proxies=1, policy-regex-filter=^(?!.*Premium).*(?:台|新北|彰化|TW|Taiwan).*$, url=http://1.0.0.1/generate_204, interval=300, tolerance=50
🇸🇬 新加坡节点 = url-test, include-all-proxies=1, policy-regex-filter=^(?!.*Premium).*(?:新加坡|坡|狮城|SG|Singapore).*$, url=http://1.0.0.1/generate_204, interval=300, tolerance=50
✅ 默认直连 = select, DIRECT
⛔️ 禁止访问 = select, REJECT
♻️ 自动选择 = url-test, include-all-proxies=1, policy-regex-filter=^((?!佣金|官网|免翻|到期|流量|更新|点外|重置|免流|Direct|GB|Days|Date|Expire|Premium).)*$, url=http://1.0.0.1/generate_204, interval=300, tolerance=50

[Rule]
# > 默认直连
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Direct/Direct.list,✅ 默认直连,update-interval=86400 // 规则修正
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/NTPService/NTPService.list,✅ 默认直连,update-interval=86400 // NTP
RULE-SET,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/GoogleCN.list,✅ 默认直连,update-interval=86400 // 谷歌中国
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AmazonCN/AmazonCN.list,✅ 默认直连,update-interval=86400 // 亚马逊中国
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Cloudflarecn/Cloudflarecn.list,✅ 默认直连,update-interval=86400 // CF中国
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/SteamCN/SteamCN.list,✅ 默认直连,update-interval=86400 // SteamCN
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Download/Download.list,✅ 默认直连,update-interval=86400 // 下载网站
# > 人工智能
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/OpenAI/OpenAI.list,AIGC,update-interval=86400 // OpenAI
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Claude/Claude.list,AIGC,update-interval=86400 // Claude
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Gemini/Gemini.list,AIGC,update-interval=86400 // Gemini
RULE-SET,https://raw.githubusercontent.com/Coldvvater/Mononoke/master/Surge/Rules/AI.list,AIGC,update-interval=86400 // AI集合
# > 苹果服务
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AppleProxy/AppleProxy.list,苹果代理,update-interval=86400 // Apple Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple_All_No_Resolve.list,苹果服务,update-interval=86400 // Apple
# > 微软服务
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Microsoft/Microsoft.list,微软服务,update-interval=86400 // Microsoft
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/OneDrive/OneDrive.list,OneDrive,update-interval=86400 //OneDrive
# > 谷歌服务
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Google/Google.list,谷歌服务,update-interval=86400 //Google
# > GitHub
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/GitHub/GitHub.list,Github,update-interval=86400 // Github
# > 游戏平台
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Epic/Epic.list,游戏平台,update-interval=86400 // Epic
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Sony/Sony.list,游戏平台,update-interval=86400 // Sony
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Steam/Steam.list,游戏平台,update-interval=86400 // Steam
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Nintendo/Nintendo.list,游戏平台,update-interval=86400 // 老任
# > 流媒体
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/YouTube/YouTube.list,Youtube,update-interval=86400 // YouTube
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/YouTubeMusic/YouTubeMusic.list,Youtube,update-interval=86400 // YouTube Music
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Netflix/Netflix.list,Netflix,update-interval=86400 // Netflix
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/TikTok/TikTok.list,TikTok,update-interval=86400 // TikTok
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Disney/Disney.list,Disney,update-interval=86400 // Disney
# > 社交媒体
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Telegram/Telegram.list,Telegram,update-interval=86400 // Telegram
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Twitter/Twitter.list,Twitter,update-interval=86400 // Twitter
# > OV代理
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Proxy/Proxy_All_No_Resolve.list,🀄️ 节点选择,update-interval=86400 // ProxyAll
# > CN直连
GEOIP,CN, DIRECT // 中国IP
# > 局域网
RULE-SET,LAN,DIRECT
# > DNS 查询失败走 Final 规则
FINAL,✅ 默认直连,dns-failed

[URL Rewrite]
^https?://(www.)?g.cn https://www.google.com 302
^https?://(www.)?google.cn https://www.google.com 302
